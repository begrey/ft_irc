# Subject ν•΄μ„

# IRC (internet Relay Chat)

- **Summary:** 
μ΄ ν”„λ΅μ νΈμ λ©ν‘λ” μ¤μ¤λ΅ μμ‹ λ§μ IRC μ„λ²„λ¥Ό λ§λ“¤μ–΄λ³΄λ” κ²ƒμ΄λ‹¤. κ·Έλ ‡κ² ν•κΈ° μ„ν•΄, μ‹¤μ  IRC ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ μ‘μ—…λ¬Όμ„ ν…μ¤νΈν•κ² λ  κ²ƒμ΄λ‹¤. μΈν„°λ„·μ€ κ²¬κ³ ν•κ³  ν‘μ¤€ ν”„λ΅ν† μ½μ„ ν†µν•΄ μ—°κ²°λ λ¨λ“  μ»΄ν“¨ν„°μ™€μ κ°•λ ¥ν• μƒνΈμ‘μ©μΌλ΅ κ·μ •λλ‹¤. μ΄κ²ƒμ— λ€ν•΄ μ•„λ” κ²ƒμ€ μ–Έμ λ‚ λ„μ›€μ΄ λ  κ²ƒμ΄λ‹¤.

## Introduction

---

 μΈν„°λ„· λ¦΄λ μ΄ μ±„ν…(IRC)λ” μΈν„°λ„· μƒμ ν…μ¤νΈ ν†µμ‹  ν”„λ΅ν† μ½μ΄λ‹¤. μ΄κ²ƒμ€ κ·Έλ£Ή μ±„ν…μ μ±„λ„μ—μ„ μ£Όλ΅ μ‚¬μ©λλ” μ¦‰κ°μ μΈ ν†µμ‹ μ΄λ©°, λ¬Όλ΅  κ°μΈκ°„μ ν†µμ‹ μ—λ„ μ‚¬μ©ν•  μ μλ‹¤.

 IRC ν΄λΌμ΄μ–ΈνΈ ν”„λ΅κ·Έλ¨μ€ νΉμ •λ μ±„λ„μ— μ ‘μ†ν•κΈ° μ„ν•΄ IRC μ„λ²„μ— μ—°κ²°ν•λ‹¤. IRC μ„λ²„λ” μ”κµ¬λ μ±„λ„μ— λ€ν• κΈ€λ΅λ² λ„¤νΈμ›ν¬λ¥Ό μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈλ“¤μ—κ² μ κ³µν•΄μ•Ό ν•λ‹¤.

## Mandatory Part

---

| Program name | ircserv |
| --- | --- |
| Trun in files |  |
| Makefile | Yes |
| Arguments |  |
| External functs. | C++98μ λ¨λ“  κ²ƒ. socket, setsockopt, getsockname, getprotobyname, gethostbyname, getaddrinfo, freeaddrinfo, bind, connect, listen, accept, htons, htonl, ntohs, ntohl, inet_addr, inet_ntoa, send, recv, signal, lseek, fstat, fcntl, poll (or equivalent) |
| Libft autorized |  |
| Description | Write an IRC server in C++98 |
- λ°λ“μ‹ C++98λ΅ IRC μ„λ²„λ¥Ό κ°λ°ν•΄μ•Ό ν•λ‹¤.
- ν•„μ”ν•λ‹¤λ©΄ C ν•¨μλ“¤μ„ μ‚¬μ©ν•  μ μμ§€λ§, C++ ν•¨μ μ‚¬μ©μ„ κ¶μ¥ν•λ‹¤.
- C++ ν‘μ¤€μ€ λ°λ“μ‹ C++98μ„ λ”°λΌμ•Ό ν•λ©°, μ΄κ²ƒμΌλ΅ μ»΄νμΌ λμ–΄μ•Ό ν•λ‹¤.
- μ™Έλ¶€ λΌμ΄λΈλ¬λ¦¬, Boostμ™€ κ°™μ€ κ²ƒλ“¤μ€ μ‚¬μ©ν•  μ μ—†λ‹¤.
- κ°€λ¥ν• ν• C++μ„ μ‚¬μ©ν•λΌ. (not C)
- μ„λΈμ νΈ μ¤μΌ€μΌμ—μ„ μ–ΈκΈ‰ν•μ§€λ§ select, kqueue, epollκ³Ό κ°™μ€ κ²ƒλ“¤μ„ μ‚¬μ©ν•  μ μλ‹¤.
- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„ ν†µμ‹ μ€ λ°λ“μ‹ TCP/IP(v4) λλ” (v6)λ¥Ό ν†µν•΄ μ΄λ£¨μ–΄μ Έμ•Ό ν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ” μ‘μ„±ν•  ν•„μ” μ—†λ‹¤.
- μ„λ²„κ°„ ν†µμ‹ μ€ μ²λ¦¬ν•  ν•„μ”κ°€ μ—†λ‹¤.
- λ‹¤μκ³Ό κ°™μ€ μ‚¬μ© λ°©μ‹μ„ κΈ°λ€ν•λ‹¤.
    
    ```bash
    	/ircserv [host:port_network:password_network] <port> <password>
    ```
    
    - `host`λ” μ΄λ―Έ μ΅΄μ¬ν•λ” λ„¤νΈμ›ν¬μ— μ—°κ²°ν•κΈ° μ„ν•΄ IRCκ°€ μ—°κ²°ν•΄μ•Ό ν•  hostnameμ΄λ‹¤.
    - `port_network`λ” hostμ—μ„ IRCκ°€ μ—°κ²°ν•  μ„λ²„ ν¬νΈμ΄λ‹¤.
    - `password_network`λ” μ—°κ²°ν•  νΈμ¤νΈμ λΉ„λ°€λ²νΈ.
    - `port`λ” μ„λ²„κ°€ μμ‹  μ—°κ²°μ„ ν—μ©ν•  ν¬νΈ λ²νΈμ΄λ‹¤.
    - `password`λ” μ„λ²„μ— μ—°κ²°ν•λ ¤λ” λ¨λ“  IRC ν΄λΌμ΄μ–ΈνΈμ— ν•„μ”ν• μ•”νΈ.
    - λ§μ•½ `host`, `port_network` κ·Έλ¦¬κ³  `password_network`κ°€ μ£Όμ–΄μ§€μ§€ μ•μ•λ‹¤λ©΄, μƒ IRC λ„¤νΈμ›ν¬λ¥Ό μƒμ„±ν•΄μ•Ό ν•λ‹¤.
- μ„λ²„λ” λ™μ‹μ— λ‹¤μ¤‘μ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ¤‘λ‹¨ μ—†μ΄ μ²λ¦¬ν•΄μ•Ό ν•λ‹¤.
fork μ‚¬μ©μ€ λ¶ν—ν•λ©° λ¨λ“  I/O μ‘μ—…μ€ blockλμ§€ μ•μ•„μ•Ό ν•λ‹¤. κ·Έλ¦¬κ³  λ¨λ“  read, write, listen, ... μ— λ€ν•΄ λ‹¨ 1κ°μ poll λλ” μ΄μ— μƒμ‘ν•λ” κ²ƒλ§ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.

<aside>
π’΅ MacOS Xλ” Unix OSμ™€ κ°™μ€ λ°©μ‹μΌλ΅ writeλ¥Ό κµ¬ν„ν•μ§€ μ•κΈ° λ•λ¬Έμ—, fcntlμ„ μ‚¬μ©ν•  μ μλ‹¤.
λ‹¤λ¥Έ OSμ™€ λΉ„μ·ν• κ²°κ³Όλ¥Ό μ–»κΈ° μ„ν•΄μ„  non-blocking FDλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.

</aside>

<aside>
π¨ non-blocking FDλ¥Ό μ‚¬μ©ν•κΈ° λ•λ¬Έμ—, ν΄λ§(λλ” κ·Έμ— λ™λ“±ν• κ²ƒ) μ—†μ΄ read / recv λλ” write / send ν•¨μλ¥Ό μ‚¬μ©ν•  μ μμΌλ©°, μ„λ²„λ” blockλμ§€ μ•μ„ κ²ƒμ΄λ‹¤. κ·Έλ¬λ‚ μ΄λ” λ” λ§μ€ μ‹μ¤ν… λ¦¬μ†μ¤λ¥Ό μ†λΉ„ν•λ‹¤.
λ”°λΌμ„ pollμ„ κ±°μΉμ§€ μ•κ³  λ¨λ“  FDμ—μ„ read / recv λλ” write / sendλ¥Ό μ¬μ‹λ„ν•λ©΄ 0μ μΌλ΅ ν‰κ°€κ°€ μΆ…λ£λλ‹¤.

</aside>

<aside>
π¨ λ‹¤μμ fcntlλ§ μ‚¬μ©ν•  μ μλ‹¤: fcntl(fd, F_SETFL, O_NONBLOCK);
κ·Έ μ™Έμ flagsλ” κΈμ§€.

</aside>

- κΉ”λ”ν• μ½”λ“λ¥Ό μ‘μ„±ν•΄μ•Ό ν•λ‹¤. λ¨λ“  μ—λ¬μ™€, λ°μƒ κ°€λ¥ν• λ¨λ“  λ¬Έμ (λ¶€λ¶„ λ°μ΄ν„° μμ‹ , λ‚®μ€ λ€μ—­ν­)μ— λ€ν• κ²€μ¦μ„ ν•  μ μμ–΄μ•Ό ν•λ‹¤.
- μ„λ²„λ΅ λ³΄λ‚΄λ” λ¨λ“  κ²ƒμ— λ€ν•΄ μ„λ²„μ μ‘λ™μ„ ν™•μΈν•κΈ° μ„ν•΄ ncλ΅ μ΄κΈ° ν…μ¤νΈλ¥Ό μν–‰ν•  μ μλ‹¤. (ctrl + d λ¥Ό μ‚¬μ©ν•μ—¬ λ…λ Ήμ μΌλ¶€λ¥Ό λ³΄λ‚Έλ‹¤.)
    
    ```bash
    \$> nc 127.0.0.1 6667
    com^Dman^Dd
    \$>
    ```
    
    μ„ λ…λ Ήμ€ μ²« μ†΅μ‹ μΌλ΅ com, man, d\nλ¥Ό λ³΄λ‚Έλ‹¤. λ¨Όμ € ν¨ν‚·μ„ μ§‘κ³„ν•μ—¬ μ»¤λ§¨λ“λ¥Ό μ²μΉν•  `command`λ΅ λ‹¤μ‹ rebuildν•΄μ•Ό ν•λ‹¤.
    
- μ΅΄μ¬ν•λ” μ—¬λ¬ IRC ν΄λΌμ΄μ–ΈνΈλ“¤ μ¤‘ ν•λ‚λ¥Ό λ””νμ¤λ¥Ό μ„ν• λ νΌλ°μ¤λ΅ μ„ νƒν•λΌ.
- μ΄ ν΄λΌμ΄μ–ΈνΈμ™€ νΈν™λλ ¤λ©΄ IRC κ³µμ‹ RFCμ μ μ–΄λ„ μΌλ¶€λ¥Ό κµ¬ν„ν•΄μ•Ό ν•λ‹¤.
- μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ κ³µμ‹ IRC μ„λ²„μ—μ„ μ‚¬μ©ν•λ” κ²ƒκ³Ό κ°™μ•„μ•Ό ν•μ§€λ§, κ³Όμ μ—μ„ μµμ†ν•μ ν•„μ κΈ°λ¥ λ‚μ—΄μ„ μ κ³µν•  κ²ƒμ΄λ‹¤.
- μ–΄λ– ν• μ¤λ¥ μ—†μ΄ λ νΌλ°μ¤λ΅ μ„ νƒν• ν΄λΌμ΄μ–ΈνΈλ¥Ό μ„λ²„μ— μ—°κ²°ν•  μ μμ–΄μ•Ό ν•λ‹¤.
- μ΄ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ μΈμ¦, λ‹‰λ„¤μ„, μ‚¬μ©μ μ΄λ¦„μ„ μ„¤μ •ν•κ³ , μ±„λ„μ— κ°€μ…ν•λ©°, κ°μΈ λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄κ³  λ°›μ„ μ μμ–΄μ•Ό ν•λ‹¤.
- μ–΄λ–¤ μ±„λ„μ— μλ” λ‹¨μΌ ν΄λΌμ΄μ–ΈνΈμ λ¨λ“  λ©”μ‹μ§€λ” μ±„λ„μ λ‹¤λ¥Έ λ¨λ“  ν΄λΌμ΄μ–ΈνΈλ΅ μ „μ†΅λμ–΄μ•Ό ν•λ‹¤.
- μ΄μμμ™€, μΌλ° μ‚¬μ©μλ΅ λ°λ“μ‹ κµ¬λ¶„λμ–΄μ•Ό ν•λ‹¤.
- μΌλ¶€ μ΄μμλ” νΉμ • μ•΅μ…/μ»¤λ§¨λ“λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.

## Bonus part

---

ν„μ‹¤μ IRCμ— κ°€κΉκ² ν•λ”, κµ¬ν„λ  IRCμ— μ¶”κ°€ν•  μ μλ” λ‡ λ‡ λ³΄λ„μ¤ ν•­λ©μ΄ μλ‹¤. λ‹Ήμ—°ν•κ²λ„ mandatory partκ°€ μ™„μ „ν•μ§€ μ•λ‹¤λ©΄, μƒκ°λ„ ν•μ§€ λ§λΌ.

- νμΌ μ „μ†΅
- λ΄‡ κΈ°λ¥